<script type='text/javascript'>
$( document ).ready(function() {
   $('#menu_left_user #cssmenu li.has-sub>a').on('click', function(){
         $(this).removeAttr('href');
         var element = $(this).parent('li');
         if (element.hasClass('open')) {
            element.removeClass('open');
            element.find('li').removeClass('open');
            element.find('ul').slideUp();
         }
         else {
            element.addClass('open');
            element.children('ul').slideDown();
            element.siblings('li').children('ul').slideUp();
            element.siblings('li').removeClass('open');
            element.siblings('li').find('li').removeClass('open');
            element.sibl5ngs('li').find('ul').slideUp();
         }
   });
});

function loadMenuInfo(url, element,menuField)
{
  var id = "";
  if ($("#menu-select").val() == "user")
    id = "/users/" + username;
  else
    id = $("#menu-select").val();
  function success(data)
  {
    $(element).parent().children("ul").html("");
    for(var i=0 ; i< data.resource_list.length ; i++) {
      $(element).parent().children("ul").append("<li><a onclick=\"javascript:loadInfoPage('" + menuField + "','" + data.resource_list[i].href + "');\" href='#' "+ ((i == data.resource_list.length -1) ? "class='last' " :"") +"><span>" + data.resource_list[i].name + "</span></a></li>");
    }
  }
  function error()
  {
  }
  get(id + url, success, error);
}

function loadInfoPage(menuField, href)
{
  url = href;
  if (menuField == "formalism")
  {
    
  }
  else if (menuField == "model")
  {
    loadPage("model");
    //$('#contenu').load("website/webclient/web_client.html");
  }
  else if (menuField == "service")
  {

  }
  else if (menuField == "execution")
  {

  }
}

function emptyMenu()
{
  $("#menu_left_user ul li ul").html("");
}
</script>
<link rel="stylesheet" type="text/css" href="css/menu_left_user.css">
<div id="menu_left_user">
<div id='cssmenu'>
<input type="search" id="search" results="5" placeholder="Search..." name="s" style="-webkit-appearance: textfield;-webkit-box-sizing: content-box; width:207px; height:25px;font-size:14px;">
<ul>
<li class='has-sub'><a href='#' onclick="javascript:loadMenuInfo('/formalisms',this,'formalism');"><span>Formalisms</span></a>
  <ul id="formalisms">
  </ul>
</li>
<li class='has-sub'><a href='#' onclick="javascript:loadMenuInfo('/models',this,'model');"><span>Models</span></a>
  <ul>
    <li><a href='#'><span>Sub Item</span></a></li>
    <li class='last'><a href='#'><span>Sub Item</span></a></li>
  </ul>
</li>
<li class='has-sub'><a href='#' onclick="javascript:loadMenuInfo('/services',this,'service');"><span>Services</span></a>
  <ul>
  </ul>
</li>
<li class='has-sub'><a href='#' onclick="javascript:loadMenuInfo('/executions',this,'execution');"><span>Executions</span></a>
  <ul>
    <li><a href='#'><span>Sub Item</span></a></li>
    <li class='last'><a href='#'><span>Sub Item</span></a></li>
  </ul>
</li>
</ul>
<select id="menu-select" name="nom" size="1" style="width:215px;height:25px;font-size:14px;" onchange="javascript:emptyMenu();">
</select>
</div>
</div>
<script type="text/javascript">
$(document).ready(function(){
  $("#menu-select").append("<option value='user'>" + complete_name + "</option>");
  function success(data)
  {
    for(var i=0 ; i< data.resource_list.length ; i++) {
      var reg=new RegExp("[/]+", "g");
      var url_reg = data.resource_list[i].href.split(reg);
      $("#menu-select").append("<option value='/projects/"+ url_reg[url_reg.length -1] +"'>" + data.resource_list[i].name + "</option>");
    }
  }
  function error(resultat, statut, erreur)
  {
    alert(erreur);
  }
  get('/users/'+ username +'/projects', success, error);
});
</script>
